@page "/createlisting"
@using Npgsql

<PageTitle>Create Listing</PageTitle>

<h3>Create Listing</h3>

<select @bind="Brand">
    <option value="">Select a brand</option>
    <option value="Sony">Sony</option>
    <option value="Bose">Bose</option>
    <option value="JBL">JBL</option>
</select>

<select @bind="Model">
    <option value="">Select a model</option>
    <option value="S1">S1</option>
    <option value="S2">S2</option>
    <option value="Other">Other</option>
</select>

<select @bind="Microphone">
    <option value="">Microphone</option>
    <option value="TRUE">TRUE</option>
    <option value="FALSE">FALSE</option>
</select>

<button @onclick="Submit">Submit</button>

@code {
    private string Brand { get; set; }
    private string Model { get; set; }
    private string Color { get; set; }
    private string FrequencyRange { get; set; }
    private bool Microphone { get; set; }
    private string TypeOfConnection { get; set; }
    private string NoiseCancellation { get; set; }
    private string ClosedOrOpen { get; set; }
    private string ItemCondition { get; set; }
    private int Price { get; set; }
    private string ImageUrl { get; set; }
    private string Type { get; set; }

    private void Submit()
    {
        string connectionString = "Host=ep-blue-fire-a2nnh5p7.eu-central-1.aws.neon.tech;Username=sonaredb_owner;Password=8LlUVraRtDs9;Database=sonaredb;SSL Mode=Require";
        using var connection = new NpgsqlConnection(connectionString);
        connection.Open();
        using (var cmd = new NpgsqlCommand())
        {
            cmd.Connection = connection;
            
            string insertCommand = $@"
                INSERT INTO Headsets(Brand, Model, Color, FrequencyRange, Microphone, TypeOfConnection, NoiseCancellation, ClosedOrOpen, ItemCondition, Price, ImageUrl, Type)
                VALUES('{Brand}', '{Model}', '{Color}', '{FrequencyRange}', {Microphone}, '{TypeOfConnection}', '{NoiseCancellation}', '{ClosedOrOpen}', '{ItemCondition}', '{Price}', '{ImageUrl}', '{Type}');";

            cmd.CommandText = insertCommand;
            cmd.ExecuteNonQuery();
        }
    }
}
